include:
  - docassemble.AssemblyLine:assembly_line.yml
  - docassemble.mlhframework:mlh_interview_framework.yml
---
metadata:
  title: Motion Regarding Change of Domicile
  short title: Change of Domicile Motion
  subtitle: Helps you write a motion asking the court to allow a change in where your child lives.
  description: |
    If there is a custody or parenting time order for your child, you must get the court’s approval before moving his or her domicile from Michigan.
  tags:
    - "Family"
    - "Domicile"
  authors:
    - Rami Lorca
    - Hayden McGuire
---
sections:
  - review_intro: "Introduction"
  - qualifying_questions: "Do you qualify?"
  - review_prior_case: "Prior Case Information"
  - review_your_info: "Your Information"
  - review_other_info: "Other Parent's Information"
  - review_children_info: "Children's Information"
  - review_moving_reason_info: "Why You Want to Move"
  - review_domestic_violence_info: "Domestic Violence"
  - review_new_address_info: "Your New Address"
  - review_parenting_time_info: "Parenting Time"
  - review_conclusion: "Conclusion"
---
code: |
  al_form_type = "existing_case"
---
id: interview config code block
code: |
  github_repo_name = "docassemble-MLHMotionRegardingChangeOfDomicile"
  MLH_court_forms = True
  MLH_time_min = 40
  MLH_time_max = 60
---
objects:
  - users: ALPeopleList.using(auto_gather=True, complete_attribute="complete", target_number=1)
  - other_parties: ALPeopleList.using(auto_gather=True, complete_attribute="complete", target_number=1)
  - children: ALPeopleList.using(auto_gather=True, ask_number=True, complete_attribute="complete")
  - presiding_judge: ALPeopleList.using(ask_number=True,target_number=1)
---
#################### Interview Order Start #####################
---
#TO DO: add appropriate sections for other parties
id: interview_order_motion_regarding_change_of_domicile
mandatory: True
code: |
  nav.set_section("review_intro")
  intro_screen
  MLH_standard_intro_pages
  court_permission_required

  nav.set_section("qualifying_questions")
  if not has_existing_case:
    existing_case_kickout
  if third_party_check:
    third_party_kickout
  what_you_will_need
  
  nav.set_section("review_prior_case")
  docket_number

  county_choice

  user_started_case
  if not prior_order_yesno:
    prior_order_kickout

  nav.set_section("review_your_info")
  users.gather()

  nav.set_section("review_other_info")
  other_parties.gather()
  nav.set_section("review_children_info")
  children.gather()

  nav.set_section("review_moving_reason_info")
  moving_reason_intro_screen
  moving_reason
  moving_benefits

  nav.set_section("review_domestic_violence_info")

  nav.set_section("review_new_address_info")

  nav.set_section("review_parenting_time_info")

  nav.set_section("review_conclusion")

  efile_notice
  if esign:
    signature_date
  
  interview_motion_re_change_of_domicile = True
---
#################### Interview Order End #####################
---
mandatory: True
code: |
  interview_motion_re_change_of_domicile
  # Store anonymous data for analytics / statistics
  store_variables_snapshot(
      persistent=True,
      data={
          "zip": showifdef("users[0].address.zip"),
          "reached_interview_end": True,
      },
  )
  motion_re_change_of_domicile_download
---
# NOTE: for users and other_parties
generic object: ALIndividual
code: |
  x.name.first
  x.address.address
  x.phone_number
  x.complete = True
---
# NOTE: ensures there is only 1 party on both sides
code: |
  users.there_is_another = False
---
code: |
  other_parties.there_are_any = True
---
code: |
  other_parties.there_is_another = False
---
code: |
  children[i].name.first
  children[i].birthdate
  children[i].complete = True
---
#################### Overridden AL Questions Start #####################
---
sets:
  - other_parties[i].name.first
  - other_parties[i].name.last
  - other_parties[i].name.middle
  - other_parties[i].name.suffix
id: names of opposing parties
question: |
  % if user_started_case:
  Name of **defendant** in this matter
  % else:
  Name of **plaintiff** in this matter
  % endif
fields:
  - code: |
      other_parties[i].name_fields(person_or_business='person')
---
id: children names without birthdate
sets:
  - children[i].name.first
  - children[i].name.last
  - children[i].name.middle
  - children[i].name.suffix
question: |
  % if children.target_number < 2:
  What is the name of your child?
  % else:
  What is the name of your ${ ordinal(i) } child?
  % endif
subquestion: |
  % if len(children.complete_elements()) > 0:
  You have already told us about ${ comma_and_list(children.complete_elements()) }.
  % endif
fields:
  - code: |
      children[i].name_fields()
---
id: how many children
question: |
  How many children do you want this change in domicile or residence for?
fields:
  - no label: children.target_number
    datatype: integer
    min: 1
    validation messages:
      min: |
        You need to have at least one child you are requesting a change in domicile or residence for.
---
#################### Overridden AL Questions End #####################
---
# TO DO: finish adding intro language
id: intro_screen
question: |
  Welcome to the Do-It-Yourself Motion Regarding Change of Domicile tool
subquestion: |
  This tool will help you prepare the forms to file a *Motion Regarding Change of Domicile* in Michigan.

  If there is a custody or parenting time order for your child, you must get the court's approval before moving their domicile from Michigan. 
continue button field: intro_screen
---
id: MLH_intro_landing
continue button field: MLH_intro_landing
question: |
  Need more help?
subquestion: |
  This tool will help you prepare forms for your legal issue without a lawyer.
  
  You may want to speak to a lawyer if any of these apply to you:

  * You have a child support order **from another state** but now you live in Michigan. In some circumstances, you may be able to have your case transferred to Michigan. However, this tool cannot help you do that.
  * There is a **bench warrant** against you for **non-payment of support**. This could happen if a motion to show cause was filed against you for non-payment of support, 
    you did not appear at the hearing, and the court issued a bench warrant against you.
  * You aren't sure what to do.

  ${ MLH_GUIDE_FULL }
---
id: court_permission_required
continue button field: court_permission_required
question: |
  When do you need court permission?
subquestion: |
  If there is a custody or parenting time order for your child, you will always need permission from the court to move them outside of Michigan.
  
  You may need permission from the court to move within Michigan. This depends on things like:

    * The custody and parenting time arrangements
    * How far your proposed move is
    * How far you lived from the other parent when your case started
    * Whether the other parent agrees to the move

  To learn more about when you need the court's permission to move, read [Moving with Children after Separation or Divorce](https://michiganlegalhelp.org/resources/family/moving-children-after-separation-or-divorce).
---
id: has_existing_case
question: |
  Do you have an existing Michigan family law case?
subquestion: |
  This includes:

    * Divorce
    * Separate maintenance
    * Paternity
    * Custody
    * Family support

fields:
  - no label: has_existing_case
    datatype: yesnoradio
---
id: existing_case_kickout
event: existing_case_kickout
question: |
  You cannot use this tool without a Michigan child support case
subquestion: |
  You said you already do not have an existing Michigan divorce, separate maintenance, paternity, custody, or family support case.
  You must have one to continue to use this tool.
  
  If you made a mistake, click the **< ${ MLH_back_button_label }** button to change your answer. Otherwise, you can return to [Michigan Legal Help](https://michiganlegalhelp.org) for other legal information or resources.
---
id: third_party_check
question: |
  Is there a non-parent party in your existing family law case?
fields:
  - "": third_party_check
    datatype: yesnoradio
---
id: third_party_kickout
event: third_party_kickout
question: |
  We’re sorry, but you cannot use this tool.
subquetion: |
  This tool may only be used to file a *Motion Regarding Change of Domicile*  in a Michigan family law case between two parents, with no third party involvement.

  We cannot help you, but your local legal aid program or other lawyer may be able to.  You can use the [Guide to Legal Help on Michigan Legal Help](https://michiganlegalhelp.org/guide-to-legal-help) to find a lawyer or a legal services office near you.

  **If the only parties involved are the parents click undo to change your answer.** 
---
# ToDo: need to fix tempalte. I think error is with image_court_papers
id: what_you_will_need
question: |
  What you will need to complete this form
subquestion: |
  To complete this form, you will need:

  * the case number,
  * court information, and
  * information about the parties from your existing case

#  ${ collapse_template(where_info_on_papers_template) }
continue button field: what_you_will_need
---
#template: where_info_on_papers_template
#subject: |
#  Where can I find this information?
#content: |
#  Here is an example of where you can find this information on your court papers.
#
#  * The court information is circled in blue, on the top left.
#  * The case number is circled in yellow, on the top right.
#  * The information about the parties is circled in red
#
#  ${ image_court_papers.show(width="100%") }
---
# TO DO: finish adding any needed language
id: MLH intro time
question: |
  Using this tool
subquestion: |
  It should take you between ${ MLH_time_min } and ${ MLH_time_max } minutes to finish answering questions.

  After that, your personalized forms to file a **Motion Regarding Change of Domicile** will be ready to print.

  You will also get a set of instructions on what you need to do next. 

continue button field: MLH_intro_time
---
id: docket number
question: |
  What is your case number?
subquestion: |
  Enter the case number from your divorce case, custody case, or other family support case.

  ${ collapse_template(where_case_number) }
fields:
  - Case number: docket_number
    maxlength: 25
---
# ToDo: add a contextualized visual to assist user correctly answer this question
id: what is the user's role?
question: |
  What party are you in your existing case?
subquestion: |
  You are called the “moving party” because you are filing the Motion Regarding Change of Domicile.  

  In your court case, you are either the Plaintiff or the Defendant.

fields: 
  - What party are you in your case?: user_ask_role
    label above field: True
    datatype: radio
    choices:
      - I am the Plaintiff: plaintiff
      - I am the Defendant: defendant
  - note: |
      Okay, you are the **Plaintiff** in this case. The other 
      side is the Defendant.
    show if:
      variable: user_ask_role
      is: "plaintiff"
  - note: |
      Okay, you are the **Defendant** in this case. The other 
      side is the Plaintiff.
    show if:
      variable: user_ask_role
      is: "defendant"
---
id: judgment or custody order
question: |
  Is there a custody order or judgment in your family law case?
fields:
  - "": prior_order_yesno
    datatype: yesnoradio
  - What is the date of the most recent order?: recent_order
    datatype: date
    show if:
      variable: prior_order_yesno
      is: True
  
  - In the most recent order of judgment, is legal custody sole or joint?: current_custody
    datatype: radio
    choices:
      - Sole
      - Joint
    show if:
      variable: prior_order_yesno
      is: True

  - Do you have sole custody?: user_custodian
    datatype: yesnoradio
    show if: 
      variable: current_custody
      is: Sole
---
id: prior_order_kickout
event: prior_order_kickout
question: |
  This tool requires a prior order.
subequestion: |
  We’re sorry, but you cannot use this tool because custody or parenting time of your children is not currently governed by a custody order or judgment.
  
  We cannot help you, but your local legal aid program or other lawyer may be able to. You can use the [Guide to Legal Help on Michigan Legal Help](https://michiganlegalhelp.org/guide-to-legal-help) to find a lawyer or a legal services office near you.

  If you think you made a mistake, you can click > Undo and change the answer to the question.
---
# id: prior order information
# question: |
#   Provide the requested information about the most recent custody order or judgment.
# feilds:
#   - In the most recent order of judgment, is legal custody sole or joint?: current_custody
#     datatype: radio
#     choices:
#       - Sole
#       - Joint
#   - Do you have sole custody?: user_custodian
#     datatype: yesnoradio
#     show if:
#       variable: current_custody
#       is: Sole 
---
id: moving_reason_intro_screen
question: |
  Why You Want to Move, Part 1  
subquestion: |
  When deciding whether to allow your move, the judge will consider whether:

    1. The move would improve your and your child’s quality of life;
    2. Each parent has followed the parenting time provisions of your court order;
    3. You are using the move to limit the other parent’s time with your child;
    4. New parenting time arrangements will allow your child to keep a similar relationship with the other parent;
    5. The other parent is fighting against the move just to pay less child support;
    6. You are moving to escape domestic violence by the other parent.

  You will now be asked about why you want the court to allow you to move. Your answers will be used to create an *Attachment to your Motion Regarding Change of Domicile/Legal Residence*.
continue button field: moving_reason_intro_screen
---
id: moving reason explanation
question: |
  Why You Want to Move, Part 2  
subquestion: |
  The court will want to know if you have a legitimate reason or reasons for moving. This is to make sure you aren’t moving just to limit the other parent’s ability to spend time with your child.
fields:
  - Please use complete sentences to explain why you want to move: moving_reason
    input type: area
---
id: moving benefits explanation
question: |
  Why You Want to Move, Part 3  
subquestion: |
  Next, explain how the move will improve your life and your child’s lives. The court may consider things like whether the move:
  
  * Is for a better job that will give your family a better standard of living;
  * Is to a safer neighborhood;
  * Is to an area with better schools;
  * Will bring you closer to extended family; and
  * Other factors unique to you.
fields:
  - The move will improve the quality of life for my child and me because...: moving_benefits
    input type: area

  - Will the move allow the child to maintain a similar relationship with ${ other_parties[0].name }?: maintains_other_parent_relationship
    datatype: yesnoradio
---
# TODO: copied from MLHMotiongRegardinChildSupport, adjust text to what's actually in our form
id: efile note question
question: |
  Completing this process does not file your forms with the court
subquestion: |
  You need to file them at court in person, by mail, e-mail, or by e-filing.
  If you are e-filing, you must use [MiFILE](https://mifile.courts.michigan.gov/).
  Read the instructions that you will get with your forms for more information.

  ${ collapse_template(am_i_going_to_efile) }

  This tool will create separate forms so you can more easily e-file using MiFILE, if you plan to e-file.
  This means that you may need to download multiple files to get all of the forms you will need.

  You will be able to get all forms you need by clicking the Download Your Form(s) button on the page at the end of this tool.
  You will then see a list of documents to download. Make sure you download each of them.
continue button field: efile_notice
---
template: am_i_going_to_efile
subject: |
  How do I know if I am going to e-file?
content: |
  Not all courts offer e-filing at this time. To find out if your court has e-filing, read the
  [What is E-Filing?](https://michiganlegalhelp.org/resources/mifile/what-e-filing) article.
  The article tells you how to find out which courts have e-filing and what kinds of cases those courts are accepting by e-filing.

  Look for the two-letter case type code at the end of your case number.
  (This could be DM, DC, DS, DP, or a different code.)
---
id: Electronic signature question
question: |
  Electronic Signature
subquestion: |
  This tool can put "*/s/ ${ users[0] }*" where you would sign your name so you do not have to sign the form by hand. The court will accept this as your signature.

  If you plan to e-file, you may want to add your electronic signature, otherwise you will need to print your forms, sign them by hand, and then scan them.

  ${ collapse_template(efiling_info_template) }
fields:
  - Would you like to add your electronic signature to your form?: esign
    datatype: yesnoradio
---
id: download Motion Regarding Change of Domicile - FOC 29
event: motion_re_change_of_domicile_download
question: |
  All done!
subquestion: |
  Thank you ${users}. Your form is ready to download and deliver.
  
  View, download and send your form below. Click the "Edit answers" button to fix any mistakes.
  
  ${ al_user_bundle.download_list_html() }
  

  ${ al_user_bundle.send_button_html(show_editable_checkbox=False) }
---
#################### Documents Start #####################
---
objects:
  - mrcd_attachment_main: ALDocument.using(title="Motion Regarding Change of Domicile", filename="Motion Regarding Change of Domicile - FOC 29.pdf", enabled=True, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
---
objects:
  - al_user_bundle: ALDocumentBundle.using(elements=[mrcd_attachment_main], filename="Motion Regarding Change of Domicile (All Forms).pdf", title="All forms to download for your records", enabled=True)
---
attachment:
  name: Motion Regarding Change of Domicile 
  filename: Motion Regarding Change of Domicile - FOC 29
  variable name: mrcd_attachment_main[i]
  skip undefined: True
  editable: False
  pdf template file: Motion Regarding Change of Domicile - FOC 29.pdf
  fields:
    - trial_court: ${ trial_court }
    - trial_court_county: ${ county_choice }
    - docket_number: ${ docket_number }
    - trial_court_address_on_one_line: ${ trial_court.address.on_one_line() }
    - trial_court_phone_number: ${ trial_court.phone_number }
    - moving_party: ${ moving_party }
    - moving_party_2: ${ moving_party_2 }
    - moving_party_3: ${ moving_party_3 }
    - recent_order: ${ recent_order }
    - joint_custody: ${ joint_custody }
    - sole_custody: ${ sole_custody }
    - plaintiff_custody: ${ plaintiff_custody }
    - defendant_custody: ${ defendant_custody }
    - plaintiffs_address_block: |
          ${ plaintiffs }
          ${ plaintiffs[0].address_on_one }
          ${ word("Does not have phone") if plaintiffs[0].no_phone_number else plaintiffs[0].phone_numbers() }
    - defendants_address_block: |
          ${ defendants }  
          ${ defendants[0].address.on_one_line() }  
          ${ word("Does not have phone") if defendants[0].no_phone_number else defendants[0].phone_numbers() }   
    - children1: ${ children[0] }
    - children2: ${ children[1] if len(children) > 1 else "" }
    - children3: ${ children[2] if len(children) > 2 else "" }
    - children4: ${ children[3] if len(children) > 3 else "" }
    - children5: ${ children[4] if len(children) > 4 else "" }
    - children6: ${ children[5] if len(children) > 5 else "" }
    - children7: ${ children[6] if len(children) > 6 else "" }
    - children_see_attached: ${ children_see_attached }
    - requested_order_see_attached: ${ requested_order_see_attached }
    - continue_current_order: ${ continue_current_order }
    - modify_current_order: ${ modify_current_order }
    - changes_to_order_see_attached: ${ changes_to_order_see_attached }
    - signature_date: ${ signature_date of esign else "" }
    - users_signature: ${ f"/s/ {users[0]}" if esign else "" }
    - presiding_judge: ${ presiding_judge.name }
    - bar_number: ${ judge_bar_number }
    - hearing_date: ${ format_date(hearing_date) if has_hearing_info else "" } 
    - hearing_time: ${ hearing_time if has_hearing_info else "" }
    - hearing_location: ${ hearing_address_on_one_line if has_hearing_info else "" }
    - service_date: ${ format_date(service_date) } 
---
#################### Documents End #####################
---